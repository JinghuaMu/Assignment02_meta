geom_hline(yintercept = 0,col = "blue", linetype = 2)+
theme_light() + theme(legend.position = "bottom")
ggplot(meta_RR, aes(y = lnRR, x = year_online, size = 1/sqrt(VRR))) + geom_point(alpha = 0.3) +
geom_smooth(method = lm, col = "red", show.legend = FALSE) + labs(x = "Publication Year",
y = "Fisher's Z-transformed Correlation Coefficient (Zr)", size = "Precision (1/SE)") +
geom_hline(yintercept = 0,col = "blue", linetype = 2)+
theme_light()
metareg_publish <- metafor::rma.mv(lnRR ~ year_c + precision, V = VRR, random = list(~1 | study, ~1 | residual),
test = "t", dfs = "contain", data = meta_RR %>% filter(precision < quantile(meta_RR$precision,0.99)))
metareg_publish
current_info <- read_csv("clark_paper_data.csv",show_col_types = FALSE)
append_info <- cbind(tibble(current_info),current_sta)
meta_RR %>% filter(VRR > (abs(10*lnRR)+2)) %>% select(study,ctrl_n:VRR)
library(tidyverse)
library(flextable)
# p_load(bookdown, devtools, ggforce, flextable, latex2exp, png, magick, metafor, MASS, emmeans, R.rsp)
# Install the orchaRd package
## devtools::install_github("daniel1noble/orchaRd", force = TRUE)
# library(orchaRd)
current_res <- read_csv("OA_activitydat_20190302_BIOL3207.csv",name_repair = "unique",show_col_types = FALSE) %>%
select(-1)
head(current_res,3)
current_res <- current_res %>% mutate(loc = as.factor(loc),species = as.factor(species),
size = as.factor(size),treatment = as.factor(treatment))
summary(current_res)
#检查NA在数据集中的分布
current_res %>% summarise(across(everything(), ~sum(is.na(.))))
#检查NA值的数量是否影响数据可用性
table(current_res[!complete.cases(current_res$activity),] %>% select(species,loc))
#删除缺失值
current_res <- current_res[complete.cases(current_res$activity),]
append_path = "ocean_meta_data.csv"
existing_res <- read_csv(append_path,show_col_types = FALSE)
glimpse(existing_res)
#观察到列名并不统一
levels(current_res$treatment)[levels(current_res$treatment)=="control"] <- "ctrl"
levels(current_res$treatment)[levels(current_res$treatment)=="CO2"] <- "oa"
#以物种和treatment为组统计其acticity的均值和sd并转化为以物种为行的长表
current_sta <- current_res %>% group_by(treatment,species) %>% summarise(mean = mean(activity),sd = sd(activity),n = n(),.groups = "drop") %>%
pivot_wider(names_from = treatment,names_glue = "{treatment}.{.value}",values_from = c(mean,n,sd))
current_info <- read_csv("clark_paper_data.csv",show_col_types = FALSE)
append_info <- cbind(tibble(current_info),current_sta)
# colnames(append_info)
#发现列的顺序和部分命名存在问题
append_info <- append_info %>%rename(Species = species) %>% select(colnames(existing_res))
# write_lines("",file = append_path,append = TRUE)
# write_csv(append_info, file = append_path, append = TRUE,col_names = FALSE)
rm(list = ls())
library(janitor)
# 修正列名方便选取
meta_data <- read_csv("ocean_meta_data.csv",show_col_types = FALSE) %>% janitor::clean_names()
glimpse(meta_data)
# 观察到部分数字型变量以chr型被读取,查看非数字变量
unique(meta_data$pub_year_if[is.na(as.numeric(meta_data$pub_year_if))])
unique(meta_data$x2017_if[is.na(as.numeric(meta_data$x2017_if))])
#通过强制类型转换将-修正为NA,将部分变量修正为因子型
meta_data[meta_data == "-"] <- NA
meta_data$cue_stimulus_type[is.na(meta_data$cue_stimulus_type)] <- "None"
meta_data <- meta_data %>% mutate(pub_year_if = as.numeric(pub_year_if), x2017_if = as.numeric(x2017_if),
effect_type = as.factor(effect_type), climate_fish_base = as.factor(climate_fish_base),
env_cue_stimulus = as.factor(env_cue_stimulus), cue_stimulus_type = as.factor(cue_stimulus_type),
species = as.factor(species))
summary(meta_data)
meta_RR <- metafor::escalc(measure = "ROM", data = meta_data,m1i = oa_mean, m2i = ctrl_mean,
sd1i = oa_sd, sd2i = ctrl_sd,n1i = oa_n, n2i = ctrl_n,var.names = c("lnRR", "VRR"))
#通过强制类型转换将-修正为NA,将部分变量修正为因子型
meta_data[meta_data == "-"] <- NA
meta_data$cue_stimulus_type[is.na(meta_data$cue_stimulus_type)] <- "None"
meta_data <- meta_data %>% mutate(pub_year_if = as.numeric(pub_year_if), x2017_if = as.numeric(x2017_if),
effect_type = as.factor(effect_type), climate_fish_base = as.factor(climate_fish_base),
env_cue_stimulus = as.factor(env_cue_stimulus), cue_stimulus_type = as.factor(cue_stimulus_type),
species = as.factor(species))
summary(meta_data)
meta_RR <- metafor::escalc(measure = "ROM", data = meta_data,m1i = oa_mean, m2i = ctrl_mean,
sd1i = oa_sd, sd2i = ctrl_sd,n1i = oa_n, n2i = ctrl_n,var.names = c("lnRR", "VRR"))
meta_RR %>% select(lnRR, VRR) %>% pivot_longer(cols = lnRR:VRR, names_to = "type", values_to = "value") %>%
ggplot(aes(x = 1,y = value)) + geom_violin() + facet_wrap(~type, scale = "free")
meta_RR %>% filter(VRR > (abs(5*lnRR)+1)) %>% select(study,ctrl_n:VRR)
print(meta_RR %>% filter(VRR > (abs(5*lnRR)+1)) %>% select(study,ctrl_n:VRR))
meta_RR %>% filter(VRR > (abs(5*lnRR)+1)) %>% select(study,ctrl_n:VRR)
meta_RR %>% filter(VRR > (abs(5*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% print()
meta_RR %>% filter(VRR > (abs(5*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% cat()
meta_RR %>% filter(VRR > (abs(5*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% head()
meta_RR %>% filter(VRR > (abs(5*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% head(10)
meta_RR %>% filter(VRR > (abs(5*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(VRR > (abs(3*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(VRR > (abs(2*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(VRR > (abs(2*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR <- meta_RR %>% filter(VRR <= (abs(2*lnRR)+1))
# 发现大多数是change
meta_RR[!complete.cases(meta_RR$lnRR),] %>% select(study,behavioural_metric, ctrl_mean,oa_mean,lnRR)
meta_RR %>% filter(VRR > (abs(2*lnRR)+1)) %>% select(study,ctrl_n:VRR)
# 发现大多数是change
meta_RR[!complete.cases(meta_RR$lnRR),] %>% select(study,behavioural_metric, ctrl_mean,oa_mean,lnRR)
doubtful_study <- unique(meta_RR[!complete.cases(meta_RR$lnRR),]$study)
num_trim <- meta_data %>% filter(study %in% doubtful_study) %>%
filter(grepl("change|Change|rate|Rate",behavioural_metric)) %>% nrow()
num_in_study <- meta_data %>% filter(study %in% doubtful_study) %>% nrow()
print(paste("Num of rows matching keywords:",num_trim,",Num of experiments:",num_in_study))
meta_RR <- meta_RR %>% filter(!(study %in% doubtful_study)) %>% filter(!grepl("change|Change",behavioural_metric)) %>%
filter(!is.na(lnRR)) %>% mutate(residual = 1:n())
write_csv(meta_RR,"meta_RR.csv")
rm(list = lm())
meta_RR <- meta_RR %>% filter(!(study %in% doubtful_study)) %>% filter(!grepl("change|Change",behavioural_metric)) %>%
filter(!is.na(lnRR)) %>% mutate(residual = 1:n())
write_csv(meta_RR,"meta_RR.csv")
rm(list = lm())
library(metafor)
meta_RR <- read_csv("meta_RR.csv")
meta_RR %>% group_by(study) %>%
summarise(n_climate = length(unique(climate_fish_base)), n_species = length(unique(species)), n_life_stage = length(unique(life_stage)),n_stimulus= length(unique(cue_stimulus_type))) %>%
pivot_longer(cols = -1,names_to = "type", values_to = "value") %>%
ggplot(aes(x = value)) + geom_histogram(binwidth = 1) + geom_text(aes(label=as.character(..count..)),stat="bin",binwidth=1,vjust=-0.5) +
facet_wrap(~type,scale = "free",nrow = 1)
meta_RR %>% group_by(species) %>%
summarise(n_study = length(unique(study)), n_life_stage = length(unique(life_stage)),n_stimulus= length(unique(cue_stimulus_type))) %>%
pivot_longer(cols = -1,names_to = "type", values_to = "value") %>%
ggplot(aes(x = value)) + geom_histogram(binwidth = 1) + geom_histogram(binwidth = 1) + geom_text(aes(label=as.character(..count..)),stat="bin",binwidth=1,vjust=-0.5) +
facet_wrap(~type,scale = "free")
# Multi-level meta-analytic model
MLMA <- metafor::rma.mv(lnRR ~ 1, V = VRR, method = "REML",
random = list(~1 |study/cue_stimulus_type,
~1 | residual), dfs = "contain", test = "t", data = meta_RR)
meta_RR <- meta_RR %>% filter(VRR <= (abs(1*lnRR)+0.5))
library(janitor)
library(metafor)
# 修正列名方便选取
meta_data <- read_csv("ocean_meta_data.csv",show_col_types = FALSE) %>% janitor::clean_names()
glimpse(meta_data)
# 观察到部分数字型变量以chr型被读取,查看非数字变量
unique(meta_data$pub_year_if[is.na(as.numeric(meta_data$pub_year_if))])
unique(meta_data$x2017_if[is.na(as.numeric(meta_data$x2017_if))])
#通过强制类型转换将-修正为NA,将部分变量修正为因子型
meta_data[meta_data == "-"] <- NA
meta_data$cue_stimulus_type[is.na(meta_data$cue_stimulus_type)] <- "None"
meta_data <- meta_data %>% mutate(pub_year_if = as.numeric(pub_year_if), x2017_if = as.numeric(x2017_if),
effect_type = as.factor(effect_type), climate_fish_base = as.factor(climate_fish_base),
env_cue_stimulus = as.factor(env_cue_stimulus), cue_stimulus_type = as.factor(cue_stimulus_type),
species = as.factor(species))
summary(meta_data)
meta_RR <- metafor::escalc(measure = "ROM", data = meta_data,m1i = oa_mean, m2i = ctrl_mean,
sd1i = oa_sd, sd2i = ctrl_sd,n1i = oa_n, n2i = ctrl_n,var.names = c("lnRR", "VRR"))
meta_RR %>% select(lnRR, VRR) %>% pivot_longer(cols = lnRR:VRR, names_to = "type", values_to = "value") %>%
ggplot(aes(x = 1,y = value)) + geom_violin() + facet_wrap(~type, scale = "free")
meta_RR %>% filter(VRR > (abs(2*lnRR)+1)) %>% select(study,ctrl_n:VRR)
meta_RR %>% filter(VRR > (abs(2*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(VRR > (abs(1*lnRR)+1)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(VRR > (abs(1*lnRR)+0.5)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(VRR > (abs(0.5*lnRR)+0.5)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(VRR > (abs(0.1*lnRR)+0.5)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(VRR > (abs(0.5*lnRR)+0.5)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(sqrt(VRR) > (abs(0.5*lnRR)+0.5)) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(sqrt(VRR) > (abs(0.5*lnRR)+log(0.5))) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(sqrt(VRR) > abs(0.5*lnRR+log(0.5))) %>% select(study,ctrl_n:VRR) %>% select(study)
meta_RR %>% filter(sqrt(VRR) > log(0.5*exp(lnRR)+ 0.5)) %>% select(study,ctrl_n:VRR) %>% select(study)
library(metafor)
meta_RR <- read_csv("meta_RR.csv")
library(tidyverse)
library(flextable)
# p_load(bookdown, devtools, ggforce, flextable, latex2exp, png, magick, metafor, MASS, emmeans, R.rsp)
# Install the orchaRd package
## devtools::install_github("daniel1noble/orchaRd", force = TRUE)
# library(orchaRd)
library(metafor)
meta_RR <- read_csv("meta_RR.csv")
meta_RR %>% group_by(study) %>%
summarise(n_climate = length(unique(climate_fish_base)), n_species = length(unique(species)), n_life_stage = length(unique(life_stage)),n_stimulus= length(unique(cue_stimulus_type))) %>%
pivot_longer(cols = -1,names_to = "type", values_to = "value") %>%
ggplot(aes(x = value)) + geom_histogram(binwidth = 1) + geom_text(aes(label=as.character(..count..)),stat="bin",binwidth=1,vjust=-0.5) +
facet_wrap(~type,scale = "free",nrow = 1)
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 20)
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 30)
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 40)
View(meta_RR)
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 40, aes(color = "effect_type"))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 40, aes(color = effect_type))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 40, aes(fill = effect_type))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 30, aes(fill = effect_type))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) + geom_smooth(data = meta_RR, aes(x = pub_year_if, y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if))  + geom_smooth(data = meta_RR, aes(x = pub_year_if, y = VRR)) + geom_histogram(bins = 50, aes(fill = effect_type))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) + geom_smooth(data = meta_RR, aes(x = pub_year_if, y = VRR))
meta_RR %>% ggplot(aes(group = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) + geom_smooth(data = meta_RR, aes(x = pub_year_if, y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) + geom_smooth(data = meta_RR, aes(x = pub_year_if, y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) + geom_smooth(data = meta_RR, aes(x = factor(pub_year_if), y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) + geom_line(data = meta_RR, aes(x = factor(pub_year_if), y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) + geom_point(data = meta_RR, aes(x = factor(pub_year_if), y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) + geom_smooth(data = meta_RR, aes(x = pub_year_if, y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) +
scale_y_continue(limits = c(0,15)) + geom_smooth(data = meta_RR, aes(x = pub_year_if, y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if)) + geom_histogram(bins = 50, aes(fill = effect_type)) +
scale_y_continuous(limits = c(0,15)) + geom_smooth(data = meta_RR, aes(x = pub_year_if, y = VRR))
meta_RR %>% ggplot(aes(x = pub_year_if, y = VRR)) +geom_bar()
meta_RR %>% ggplot(aes(x = pub_year_if, y = VRR)) +geom_smooth()
meta_RR %>% ggplot(aes(x = pub_year_if, y = VRR, color = effect_type)) +geom_smooth()
meta_RR %>% ggplot(aes(x = VRR, y = pub_year_if, color = effect_type)) +geom_smooth()
meta_RR %>% ggplot(aes(x = pub_year_if , y = avarage_n, color = effect_type)) +geom_smooth()
meta_RR %>% ggplot(aes(x = pub_year_if, y = average_n, color = effect_type)) +geom_smooth()
View(meta_RR)
meta_RR %>% ggplot(aes(x = pub_year_if, y = average_n, color = effect_type)) +geom_point()
meta_RR %>% group_by(study) %>% select(pub_year_if, average_n, effect_type) %>% ggplot(aes(x = pub_year_if, y = average_n, color = effect_type)) +geom_point()
meta_RR %>% group_by(study) %>% select(pub_year_if, average_n, effect_type) %>% ggplot(aes(x = pub_year_if, y = average_n, color = effect_type)) +geom_point() + xlim(0,20) + ylim(0,100)
meta_RR %>% group_by(study) %>% select(pub_year_if, VRR, effect_type) %>% ggplot(aes(x = pub_year_if, y = VRR, color = effect_type)) +geom_point() + xlim(0,20) + ylim(0,100)
meta_RR %>% group_by(study) %>% select(pub_year_if, VRR, effect_type) %>% ggplot(aes(x = pub_year_if, y = VRR, color = effect_type)) +geom_point() + xlim(0,20) + ylim(0,20)
meta_RR %>% group_by(study) %>% select(pub_year_if, VRR, effect_type)
meta_RR %>% select(pub_year_if, VRR, effect_type, average_n) %>%  distict(study)
meta_RR %>% select(pub_year_if, VRR, effect_type, average_n) %>%  distinct(study)
meta_RR %>% select(study, pub_year_if, VRR, effect_type, average_n) %>%  distinct(study)
meta_RR %>% distinct(study, pub_year_if, VRR, effect_type, average_n)
meta_RR %>% select(study, pub_year_if, VRR, effect_type, average_n) %>% distinct()
meta_RR %>% mutate(mean_VRR = mean(VRR)) %>% select(study, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
meta_RR %>% group_by(study) %>% (mean_VRR = mean(VRR)) %>% select(study, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% select(study, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_data <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% select(study,year_obline, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_data <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","<10","<20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] ) %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","<10","<20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","<10","<20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)]%>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] ) %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] ) %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% drop_na() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] ) %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% drop.na() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] ) %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% drop_na() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] ) %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct()
study_info %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] ) %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] ) %>% fct_relevel(if_range,"<5","5-10","10-20")
?fct_relevel
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_violin()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_violin() + geom_jitter()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_violin() + geom_jitter(color = effect_type)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_violin() + geom_jitter(aes(color = effect_type))
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_violin()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_count()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_count(aes(fill=effect_type))
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_count(aes(color=effect_type))
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type))
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 50)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 1)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.05)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.1)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
fct_relevel(study_info$if_range,"<5","5-10","10-20",">20")
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.03)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range"<5","5-10","10-20"),y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"<5","5-10","10-20"),y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info %>%
ggplot(aes(x= fct_relevel(if_range,NA,"<5","5-10","10-20"),y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info %>%
ggplot(aes(x= fct_relevel(if_range,"<5","5-10","10-20"),y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"<5","5-10","10-20"),y=mean_VRR,fill=effect_type)) + geom_dotplot(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"<5","5-10","10-20"),y=mean_VRR,fill=effect_type)) + geom_bar(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("<5","5-10","10-20",">20")[findInterval(study_info$pub_year_if,c(0,5,10,20,100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"<5","5-10","10-20"),fill=effect_type)) + geom_bar(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-25","25-50","50-75","75+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.25),quantile(study_info$pub_year_if,0.5),quantile(study_info$pub_year_if,0.75),100),all.inside = T)] )
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-25","25-50","50-75","75+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.25,T),quantile(study_info$pub_year_if,0.5,T),quantile(study_info$pub_year_if,0.75,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"0-25","25-50","50-75"),fill=effect_type)) + geom_bar(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20","20-40","40-60","60-80","80+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),100),quantile(study_info$pub_year_if,0.8,T),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"0-25","25-50","50-75"),fill=effect_type)) + geom_bar(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20","20-40","40-60","60-80","80+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"0-25","25-50","50-75"),fill=effect_type)) + geom_bar(aes(color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20","20-40","40-60","60-80","80+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"0-25","25-50","50-75"),fill=effect_type)) + geom_bar(aes(color=effect_type), binwidth = 0.06,position = "stack")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20","20-40","40-60","60-80","80+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"0-25","25-50","50-75"),fill=effect_type)) + geom_bar(aes(x = after_stat(prob),color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20","20-40","40-60","60-80","80+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"0-25","25-50","50-75"),fill=effect_type)) + geom_bar(aes(x = after_stat(x),color=effect_type), binwidth = 0.06)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20","20-40","40-60","60-80","80+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"0-25","25-50","50-75"),fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20","20-40","40-60","60-80","80+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= fct_relevel(if_range,"0-25","25-50","50-75"),fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20","20-40","40-60","60-80","80+")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y = VRR)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y = mean_VRR)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y = avarage_n)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,y = average_n)) + geom_boxplot()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(avarage_n,precision,names_to = "trait", values_to = "value")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(average_n,precision,names_to = "trait", values_to = "value")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(average_n:precision,names_to = "trait", values_to = "value")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value")
ggplot(aes(x= if_range,y = value)) + geom_boxplot() + facet_wrap(~trait)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot() + facet_wrap(~trait)
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot() + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot(notch = TRUE) + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot() + facet_wrap(~trait,scale = "free")
>geom_boxplot()
?geom_boxplot
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + stat_boxplot(lower = 15) + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + stat_boxplot(lower = 0.15) + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + stat_boxplot(lower = 0.2,upper = 0.8) + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + stat_boxplot(lower = 0.2,middle = 0.5,upper = 0.8) + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + stat_boxplot(lower = 0.2) + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot() + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot(outlier.shape = NA) + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot() + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot() + facet_wrap(~trait,scale = "free") + geom_smooth()
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(x= if_range,y = value)) + geom_boxplot() + geom_smooth() + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(y= if_range,x = value)) + geom_boxplot() + geom_smooth() + facet_wrap(~trait,scale = "free")
study_info <- meta_RR %>% group_by(study) %>% mutate(mean_VRR = mean(VRR)) %>% ungroup() %>%  select(study,year_online, pub_year_if,mean_VRR, effect_type, average_n) %>% distinct() %>% mutate(if_range = c("0-20%","20-40%","40-60%","60-80%","80-100%")[findInterval(study_info$pub_year_if,c(0,quantile(study_info$pub_year_if,0.2,T),quantile(study_info$pub_year_if,0.4,T),quantile(study_info$pub_year_if,0.6,T),quantile(study_info$pub_year_if,0.8,T),100),all.inside = T)] )
study_info %>% drop_na() %>%
ggplot(aes(x= if_range,fill=effect_type)) + geom_bar(aes(color=effect_type), position = "fill")+scale_y_continuous(labels = scales::percent)
study_info %>% drop_na() %>% mutate(precision = 1/sqrt(mean_VRR)) %>% pivot_longer(c(average_n,precision),names_to = "trait", values_to = "value") %>%
ggplot(aes(y= if_range,x = value)) + geom_boxplot() + facet_wrap(~trait,scale = "free",nrow = 2)
meta_RR <- meta_RR %>% mutate(precision = 1/sqrt(VRR)) %>%  mutate(
exact = case_when(
precision < 5 ~ "low",
precision >= 5 & precision < 30 ~ "normal",
precision >= 30 & precision < 500 ~ "exact",
precision >= 500 ~ "extra_exact",
)) %>% mutate(exact = fct_relevel(as.factor(exact),"low","normal","exact"))
meta_RR %>% ggplot(aes(y = precision, x = lnRR)) + geom_point() + facet_wrap(~exact, scale = "free")
meta_RR %>% count(across(exact)) %>% mutate(ratio = round(n/nrow(meta_RR),3))
metafor::funnel(x = meta_RR$lnRR, vi = meta_RR$VRR, yaxis = "seinv",
digits = 2, level = c(0.1, 0.05, 0.01), shade = c("#e9fbff", "#dcf0ef", "#bac8cc"),ylim = c(1,30),xlim = c(-4,4),
las = 1, xlab = "Correlation Coefficient (r)", atransf = exp, legend = TRUE, pch =20)
library(ggpmisc)
anti_funnel <- function(data){
ggplot(data, aes(y = lnRR, x = VRR)) + geom_point() + geom_smooth(method = lm, formula = y~x) +
labs(y = "Fisher's Z-transformed Correlation Coefficient (Zr)", x = "Sampling Variance of Zr") +
stat_poly_eq(use_label(c("eq","R2", "R2.CI", "P"), sep = "*\"; \"*"),
formula = y~x , label.x = 8, parse = TRUE) +
theme_classic()
}
anti_funnel(meta_RR)
meta_RR %>% filter(VRR < quantile(meta_RR$VRR,0.98)) %>% anti_funnel()
metareg_v <- metafor::rma.mv(lnRR ~ VRR, V = VRR, random = list(~1 | study, ~1 | residual),
test = "t", dfs = "contain", data = meta_RR)
